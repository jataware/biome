datatype: api
description: |
  This API is the primary place to obtain row-level data
  from the EPA's Air Quality System (AQS) database. AQS contains
  ambient air sample data collected by state, local, tribal, and federal
  air pollution control agencies from thousands of monitors around the nation.
  It also contains meteorological data, descriptive information about
  each monitoring station (including its geographic location and its operator),
  and information about the quality of the samples. Note, AQS does not contain
  real-time air quality data (it can take 6 months from the time
  data is collected until it is in AQS). For real-time data, please use
  the AirNow API.
img_url: null
last_updated: null
name: EPA Air Quality System
provider: adhoc:specialist_agents
resources:
  00b2ebdf-94ff-475f-be91-a1f69e1b4403:
    code: "import os\nimport requests\nimport pandas as pd\nfrom datetime import datetime\n\
      import calendar\n\n# API configuration\nbase_url = \"https://aqs.epa.gov/data/api\"\
      \nemail = os.environ.get(\"API_EPA_AQS_EMAIL\")\nkey = os.environ.get(\"API_EPA_AQS\"\
      )\n\n# Define parameters\nparameters = {\n    'Ozone': 44201,\n    'CO': 42101,\
      \ \n    'NO2': 42602,\n    'PM2.5': 88101\n}\n\n# Harris County, TX codes\n\
      state_code = '48'\ncounty_code = '201'\nyear = 2022\n\ndef get_monthly_data(param_code,\
      \ month):\n    # Get number of days in month\n    num_days = calendar.monthrange(year,\
      \ month)[1]\n    \n    params = {\n        'email': email,\n        'key': key,\n\
      \        'param': param_code,\n        'bdate': f'{year}{month:02d}01',\n  \
      \      'edate': f'{year}{month:02d}{num_days}',\n        'state': state_code,\n\
      \        'county': county_code\n    }\n    \n    response = requests.get(f\"\
      {base_url}/dailyData/byCounty\", params=params)\n    return response.json()\n\
      \n# Initialize empty list to store all data\nall_data = []\n\n# Loop through\
      \ each parameter and month\nfor param_name, param_code in parameters.items():\n\
      \    for month in range(1, 13):\n        try:\n            data = get_monthly_data(param_code,\
      \ month)\n            \n            if 'Data' in data:\n                for\
      \ record in data['Data']:\n                    all_data.append({\n         \
      \               'date': record['date_local'],\n                        'parameter':\
      \ param_name,\n                        'value': record['arithmetic_mean'],\n\
      \                        'units': record['units_of_measure'],\n            \
      \            'site': record['site_number'],\n                        'latitude':\
      \ record['latitude'],\n                        'longitude': record['longitude']\n\
      \                    })\n        except Exception as e:\n            print(f\"\
      Error fetching data for {param_name} in month {month}: {str(e)}\")\n\n# Convert\
      \ to DataFrame\ndf = pd.DataFrame(all_data)\n\n# Convert date string to datetime\n\
      df['date'] = pd.to_datetime(df['date'])\n\n# Sort by date and parameter\ndf\
      \ = df.sort_values(['date', 'parameter'])\n\n# Save to CSV\ndf.to_csv('harris_county_air_quality_2022.csv',\
      \ index=False)\n"
    integration: 18e5974c-8cea-4fe7-88db-7c5779a17d5d
    notes: null
    query: Retrieve daily air quality data for ozone, CO, NO2, and PM2.5 in Harris
      County, TX for each month of the year 2022.
    resource_id: 00b2ebdf-94ff-475f-be91-a1f69e1b4403
    resource_type: example
  07d42e21-2e7d-467a-878b-e0f7572f3b8d:
    code: |
      import requests
      import os

      # Get API credentials from environment variables
      email = os.environ.get("API_EPA_AQS_EMAIL")
      key = os.environ.get("API_EPA_AQS")

      # Define the API endpoint and parameters
      state_code = 12 # "Florida"
      county_code = 117 # "Seminole" county
      year = 2000
      # codes can be fetched from /list/parametersByClass?email={email}&key={key}&pc=ALL
      # These are asthma related pollutant/parameter codes:
      pollutant_codes = [
          '44201', # ozone
          '81102', # PM10
          '81104', # PM2.5
          '42602', # Nitrogen dioxide (NO2)
          '42401', # Sulfur dioxide
          '42101', # Carbon monoxide
      ]

      bdate = f"{year}0501"
      edate = f"{year}0501"

      # Construct the API URL
      param_string = ','.join(pollutant_codes)

      url = f'https://aqs.epa.gov/data/api/annualData/byCounty?email={email}&key={key}&param={param_string}&bdate={bdate}&edate={edate}&state={state_code}&county={county_code}'

      # Make the API request
      response = requests.get(url)

      data = None
      # Check if the request was successful
      if response.status_code == 200:
          data = response.json()

      data
    integration: 18e5974c-8cea-4fe7-88db-7c5779a17d5d
    notes: null
    query: Query annual air pollution data for Seminole County, Florida for the year
      2000. Use pollutants relating to asthma.
    resource_id: 07d42e21-2e7d-467a-878b-e0f7572f3b8d
    resource_type: example
  14b7c79f-eec0-4fa0-b6bc-42a7b81c85c6:
    code: "import os\nimport requests\nimport pandas as pd\nimport matplotlib.pyplot\
      \ as plt\nimport seaborn as sns\n\n# Get authentication details from environment\
      \ variables\nemail = os.environ.get(\"API_EPA_AQS_EMAIL\")\napi_key = os.environ.get(\"\
      API_EPA_AQS\")\n\n# Base URL for the EPA AQS API\nbase_url = \"https://aqs.epa.gov/data/api\"\
      \n\n# Function to make API requests\ndef get_aqs_data(endpoint, params=None):\n\
      \    \"\"\"\n    Make a request to the EPA AQS API\n    \n    Parameters:\n\
      \    -----------\n    endpoint : str\n        The API endpoint to query\n  \
      \  params : dict\n        Additional parameters for the request\n        \n\
      \    Returns:\n    --------\n    dict\n        The JSON response from the API\n\
      \    \"\"\"\n    # Add authentication parameters\n    if params is None:\n \
      \       params = {}\n    params['email'] = email\n    params['key'] = api_key\n\
      \    \n    # Make the request\n    url = f\"{base_url}/{endpoint}\"\n    response\
      \ = requests.get(url, params=params)\n    \n    # Check if the request was successful\n\
      \    if response.status_code == 200:\n        return response.json()\n    else:\n\
      \        print(f\"Error: {response.status_code}\")\n        print(response.text)\n\
      \        return None\n\n# Get list of parameter classes\nclasses_response =\
      \ get_aqs_data(\"list/classes\")\n\n# Check if we got a valid response for classes\n\
      if classes_response and classes_response.get('Header', [{}])[0].get('status')\
      \ == 'Success':\n    # Convert to DataFrame for easier viewing\n    classes_data\
      \ = classes_response.get('Data', [])\n    classes_df = pd.DataFrame(classes_data)\n\
      \    \n    print(\"Parameter Classes:\")\n    print(classes_df)\n    \n    #\
      \ Now get parameters for the CRITERIA class (most relevant to air quality standards)\n\
      \    criteria_params_response = get_aqs_data(\"list/parametersByClass\", {\"\
      pc\": \"CRITERIA\"})\n    \n    if criteria_params_response and criteria_params_response.get('Header',\
      \ [{}])[0].get('status') == 'Success':\n        # Convert to DataFrame for easier\
      \ viewing\n        criteria_params_data = criteria_params_response.get('Data',\
      \ [])\n        criteria_params_df = pd.DataFrame(criteria_params_data)\n   \
      \     \n        print(f\"\\nFound {len(criteria_params_data)} criteria pollutant\
      \ parameters\")\n        print(\"\\nCriteria pollutant parameters:\")\n    \
      \    print(criteria_params_df)\n        \n        # Create a dictionary of key\
      \ parameter codes for asthma research\n        asthma_param_codes = {\n    \
      \        'Ozone': '44201',\n            'PM2.5': '88101',\n            'PM10':\
      \ '81102',\n            'NO2': '42602',\n            'SO2': '42401',\n     \
      \       'CO': '42101'\n        }\n        \n        print(\"\\nKey parameter\
      \ codes for asthma research:\")\n        for pollutant, code in asthma_param_codes.items():\n\
      \            print(f\"{pollutant}: {code}\")\n    else:\n        print(\"Failed\
      \ to retrieve criteria parameters data\")\nelse:\n    print(\"Failed to retrieve\
      \ parameter classes data\")\n"
    integration: 18e5974c-8cea-4fe7-88db-7c5779a17d5d
    notes: null
    query: |-
      Retrieving and exploring parameter classes and codes for air quality research. This example demonstrates how to get a list of parameter classes, then retrieve specific parameters within the CRITERIA class, which contains the most important air pollutants for health research. It also identifies key parameter codes relevant to asthma research.
    resource_id: 14b7c79f-eec0-4fa0-b6bc-42a7b81c85c6
    resource_type: example
  19afbed5-92dc-48af-9354-55a544e417ce:
    code: "import requests\nimport os\n\n# Get API credentials from environment variables\n\
      email = os.environ.get(\"API_EPA_AQS_EMAIL\")\nkey = os.environ.get(\"API_EPA_AQS\"\
      )\n\n# Define parameters\nstate_code = \"12\"  # Florida\ncounty_code = \"095\"\
      \ # Orange County\nparam_codes = [\n    \"44201\",  # Ozone\n    \"42401\",\
      \  # SO2\n    \"42101\",  # CO \n    \"42602\",  # NO2\n    \"88101\"   # PM2.5\n\
      ]\n\n# Use annual data API endpoint since we want historical data\n# Sample\
      \ every 5 years from 1980-2020 to avoid too many API calls\nyears = range(1980,\
      \ 2021, 5)\n\n# Initialize list to store results\nall_data = []\n\n# Make API\
      \ requests for each year\nfor year in years:\n    bdate = f\"{year}0101\"\n\
      \    edate = f\"{year}1231\"\n    \n    url = f\"https://aqs.epa.gov/data/api/annualData/byCounty\"\
      \n    params = {\n        \"email\": email,\n        \"key\": key,\n       \
      \ \"param\": \",\".join(param_codes),\n        \"bdate\": bdate,\n        \"\
      edate\": edate,\n        \"state\": state_code,\n        \"county\": county_code\n\
      \    }\n    \n    response = requests.get(url, params=params)\n    \n    if\
      \ response.status_code == 200:\n        data = response.json()\n        if \"\
      Data\" in data:\n            all_data.extend(data[\"Data\"])\n        else:\n\
      \            print(f\"No data found for year {year}\")\n    else:\n        print(f\"\
      Error {response.status_code}: {response.text}\")\n\n# Check the structure of\
      \ the collected data\nif all_data:\n    print(all_data[0])  # Print the first\
      \ entry to see the structure\n    df = pd.DataFrame(all_data)\n    \n    # Clean\
      \ up the DataFrame\n    if not df.empty:\n        # Select relevant columns\n\
      \        # parameter_name doesn't exist- use `parameter` or `parameter_code`:\n\
      \        cols = ['parameter', 'year', 'arithmetic_mean',  \n               \
      \ 'first_max_value', 'first_max_datetime',\n                'observation_count']\n\
      \        df = df[cols]\n        \n        # Sort by year and parameter\n   \
      \     df = df.sort_values(['year', 'parameter'])\n        \n        # Convert\
      \ year to int\n        df['year'] = df['year'].astype(int)\n        \n     \
      \   # Display first few rows\n        print(df.head())\n    else:\n        print(\"\
      No data found for the specified parameters\")\nelse:\n    print(\"No data collected.\"\
      )\n"
    integration: 18e5974c-8cea-4fe7-88db-7c5779a17d5d
    notes: null
    query: Collect historical air quality data from the EPA Air Quality System (AQS)
      for Orange County, FL.
    resource_id: 19afbed5-92dc-48af-9354-55a544e417ce
    resource_type: example
  365697ce-eb50-444b-8a82-637a2a0131f4:
    filepath: aqs.json
    integration: 18e5974c-8cea-4fe7-88db-7c5779a17d5d
    name: raw_documentation
    resource_id: 365697ce-eb50-444b-8a82-637a2a0131f4
    resource_type: file
  39430090-3680-4065-9bd1-7755ba712889:
    code: "def get_pollutant_data(state_code, county_code, param_code, year, pollutant_name):\n\
      \    \"\"\"\n    Get and process data for a specific pollutant\n    \n    Parameters:\n\
      \    -----------\n    state_code : str\n        Two-digit state code\n    county_code\
      \ : str\n        Three-digit county code\n    param_code : str\n        Parameter\
      \ code for the pollutant\n    year : str\n        Year to retrieve data for\n\
      \    pollutant_name : str\n        Name of the pollutant (for display purposes)\n\
      \        \n    Returns:\n    --------\n    pandas.DataFrame or None\n      \
      \  DataFrame containing the processed data, or None if the request failed\n\
      \    \"\"\"\n    print(f\"Retrieving daily {pollutant_name} data for Harris\
      \ County, TX for {year}...\")\n    \n    bdate = f\"{year}0101\"  # January\
      \ 1st of the year\n    edate = f\"{year}1231\"  # December 31st of the year\n\
      \    \n    data_response = get_aqs_data(\"dailyData/byCounty\", {\n        \"\
      state\": state_code,\n        \"county\": county_code,\n        \"param\": param_code,\n\
      \        \"bdate\": bdate,\n        \"edate\": edate\n    })\n    \n    if data_response\
      \ and data_response.get('Header', [{}])[0].get('status') == 'Success':\n   \
      \     data = data_response.get('Data', [])\n        df = pd.DataFrame(data)\n\
      \        \n        # Convert date_local to datetime\n        df['date'] = pd.to_datetime(df['date_local'])\n\
      \        \n        # Group by site and date to get daily averages for each site\n\
      \        site_daily_avg = df.groupby(['local_site_name', 'date'])['arithmetic_mean'].mean().reset_index()\n\
      \        \n        # Get the overall daily average across all sites\n      \
      \  daily_avg = site_daily_avg.groupby('date')['arithmetic_mean'].mean().reset_index()\n\
      \        \n        # Rename the arithmetic_mean column to the pollutant name\
      \ for clarity\n        daily_avg = daily_avg.rename(columns={'arithmetic_mean':\
      \ pollutant_name.lower()})\n        \n        return daily_avg, df['units_of_measure'].iloc[0]\n\
      \    else:\n        print(f\"Failed to retrieve {pollutant_name} data\")\n \
      \       return None, None\n"
    integration: 18e5974c-8cea-4fe7-88db-7c5779a17d5d
    notes: null
    query: 'Here''s a reusable function for retrieving and processing data for multiple
      pollutants:'
    resource_id: 39430090-3680-4065-9bd1-7755ba712889
    resource_type: example
  4245dd8c-005b-4bfa-b50e-ba076b53ffbe:
    code: "import requests\nfrom genson import SchemaBuilder\nimport os\n\n# Get API\
      \ credentials from environment variables\nemail = os.environ.get(\"API_EPA_AQS_EMAIL\"\
      )\nkey = os.environ.get(\"API_EPA_AQS\")\n\n# Define parameters\nstate_code\
      \ = \"48\"  # Texas\ncounty_code = \"201\" # Harris County\nparam_codes = [\n\
      \    \"44201\",  # Ozone\n    \"42401\",  # SO2\n    \"42101\",  # CO \n   \
      \ \"42602\",  # NO2\n    \"88101\", # PM2.5\n    \"81102\"  # PM10\n]\n\n# Sample\
      \ one year to inspect the response structure\nyear = 2020\nbdate = f\"{year}0101\"\
      \nedate = f\"{year}1231\"\n\nurl = f\"https://aqs.epa.gov/data/api/annualData/byCounty\"\
      \nparams = {\n    \"email\": email,\n    \"key\": key,\n    \"param\": \",\"\
      .join(param_codes),\n    \"bdate\": bdate,\n    \"edate\": edate,\n    \"state\"\
      : state_code,\n    \"county\": county_code\n}\n\nresponse = requests.get(url,\
      \ params=params)\nresponse_data = response.json()\n\n# annual data by county\
      \ can include a lot of data, especially if we specify a broad date range and\
      \ a county with a lot of data- lets generate a schema and inspect that instead\
      \ of inspecting the raw data\nbuilder = SchemaBuilder()\nbuilder.add_object(response_data)\n\
      schema = builder.to_schema()\n\nprint(schema[\"properties\"])\n"
    integration: 18e5974c-8cea-4fe7-88db-7c5779a17d5d
    notes: null
    query: |-
      Inspect API response change by generating a schema from an API response so that we don't inspect the raw data and blow up the context window.
    resource_id: 4245dd8c-005b-4bfa-b50e-ba076b53ffbe
    resource_type: example
  e643cf2e-66f1-428e-8f2c-2626c4c59192:
    code: "import os\nimport requests\nimport pandas as pd\nimport matplotlib.pyplot\
      \ as plt\nimport seaborn as sns\nfrom datetime import datetime\n\n# Set the\
      \ style for our plots\nsns.set(style=\"whitegrid\")\nplt.rcParams['figure.figsize']\
      \ = (12, 6)\n\n# Get authentication details from environment variables\nemail\
      \ = os.environ.get(\"API_EPA_AQS_EMAIL\")\napi_key = os.environ.get(\"API_EPA_AQS\"\
      )\n\n# Base URL for the EPA AQS API\nbase_url = \"https://aqs.epa.gov/data/api\"\
      \n\n# Function to make API requests\ndef get_aqs_data(endpoint, params=None):\n\
      \    \"\"\"\n    Make a request to the EPA AQS API\n    \n    Parameters:\n\
      \    -----------\n    endpoint : str\n        The API endpoint to query\n  \
      \  params : dict\n        Additional parameters for the request\n        \n\
      \    Returns:\n    --------\n    dict\n        The JSON response from the API\n\
      \    \"\"\"\n    # Add authentication parameters\n    if params is None:\n \
      \       params = {}\n    params['email'] = email\n    params['key'] = api_key\n\
      \    \n    # Make the request\n    url = f\"{base_url}/{endpoint}\"\n    response\
      \ = requests.get(url, params=params)\n    \n    # Check if the request was successful\n\
      \    if response.status_code == 200:\n        return response.json()\n    else:\n\
      \        print(f\"Error: {response.status_code}\")\n        print(response.text)\n\
      \        return None\n\n# Function to get and process data for a specific pollutant\n\
      def get_pollutant_data(state_code, county_code, param_code, year, pollutant_name):\n\
      \    \"\"\"\n    Get and process data for a specific pollutant\n    \n    Parameters:\n\
      \    -----------\n    state_code : str\n        Two-digit state code\n    county_code\
      \ : str\n        Three-digit county code\n    param_code : str\n        Parameter\
      \ code for the pollutant\n    year : str\n        Year to retrieve data for\n\
      \    pollutant_name : str\n        Name of the pollutant (for display purposes)\n\
      \        \n    Returns:\n    --------\n    pandas.DataFrame or None\n      \
      \  DataFrame containing the processed data, or None if the request failed\n\
      \    \"\"\"\n    print(f\"Retrieving daily {pollutant_name} data for {year}...\"\
      )\n    \n    bdate = f\"{year}0101\"  # January 1st of the year\n    edate =\
      \ f\"{year}1231\"  # December 31st of the year\n    \n    data_response = get_aqs_data(\"\
      dailyData/byCounty\", {\n        \"state\": state_code,\n        \"county\"\
      : county_code,\n        \"param\": param_code,\n        \"bdate\": bdate,\n\
      \        \"edate\": edate\n    })\n    \n    if data_response and data_response.get('Header',\
      \ [{}])[0].get('status') == 'Success':\n        data = data_response.get('Data',\
      \ [])\n        df = pd.DataFrame(data)\n        \n        print(f\"\\nFound\
      \ {len(data)} daily {pollutant_name} records for {year}\")\n        \n     \
      \   # Convert date_local to datetime\n        df['date'] = pd.to_datetime(df['date_local'])\n\
      \        \n        # Extract month and day of week for analysis\n        df['month']\
      \ = df['date'].dt.month\n        df['month_name'] = df['date'].dt.month_name()\n\
      \        \n        # Group by site and date to get daily averages for each site\n\
      \        site_daily_avg = df.groupby(['local_site_name', 'date'])['arithmetic_mean'].mean().reset_index()\n\
      \        \n        # Get the overall daily average across all sites\n      \
      \  daily_avg = site_daily_avg.groupby('date')['arithmetic_mean'].mean().reset_index()\n\
      \        \n        # Rename the arithmetic_mean column to the pollutant name\
      \ for clarity\n        daily_avg = daily_avg.rename(columns={'arithmetic_mean':\
      \ pollutant_name.lower()})\n        \n        return daily_avg, df['units_of_measure'].iloc[0]\n\
      \    else:\n        print(f\"Failed to retrieve {pollutant_name} data\")\n \
      \       return None, None\n\n# Set up parameters\nstate_code = \"48\"  # Texas\n\
      county_code = \"201\"  # Harris County\nyear = \"2022\"\n\n# Define pollutants\
      \ to retrieve\npollutants = {\n    'Ozone': '44201',\n    'PM2.5': '88101',\n\
      \    'NO2': '42602',\n    'SO2': '42401'\n}\n\n# Get data for each pollutant\n\
      pollutant_data = {}\nunits = {}\n\nfor pollutant_name, param_code in pollutants.items():\n\
      \    daily_avg, unit = get_pollutant_data(state_code, county_code, param_code,\
      \ year, pollutant_name)\n    if daily_avg is not None:\n        pollutant_data[pollutant_name.lower()]\
      \ = daily_avg\n        units[pollutant_name.lower()] = unit\n\n# Merge all pollutant\
      \ data on date\nmerged_df = None\n\nfor pollutant_name, daily_avg in pollutant_data.items():\n\
      \    if merged_df is None:\n        merged_df = daily_avg\n    else:\n     \
      \   merged_df = pd.merge(merged_df, daily_avg[['date', pollutant_name]], on='date',\
      \ how='outer')\n\n# Calculate correlations between pollutants\nif merged_df\
      \ is not None:\n    print(\"\\nCorrelations between pollutants:\")\n    correlation_matrix\
      \ = merged_df.drop('date', axis=1).corr()\n    print(correlation_matrix)\n \
      \   \n    # Plot correlation heatmap\n    plt.figure(figsize=(10, 8))\n    sns.heatmap(correlation_matrix,\
      \ annot=True, cmap='coolwarm', vmin=-1, vmax=1, center=0)\n    plt.title(f'Correlation\
      \ Matrix of Air Pollutants ({year})', fontsize=16)\n    plt.tight_layout()\n\
      \    plt.show()\n"
    integration: 18e5974c-8cea-4fe7-88db-7c5779a17d5d
    notes: null
    query: |-
      Multi-pollutant correlation analysis for air quality research. This example demonstrates how to retrieve data for multiple pollutants (Ozone, PM2.5, NO2, and SO2), process the data to get daily averages, merge the datasets, and analyze correlations between different pollutants. It includes a visualization of the correlation matrix using a heatmap.
    resource_id: e643cf2e-66f1-428e-8f2c-2626c4c59192
    resource_type: example
slug: epa_air_quality_system
source: "# OpenAPI Spec JSON:\n${raw_documentation}\n\n# Additional Instructions:\n\
  \nThis API is through OpenAPI Spec (Swagger). You will be provided the schema.\n\
  All requests go to the following URL: https://aqs.epa.gov/data/api\nThat is the\
  \ base URL for all requests.\n\nTo use the AQS API always retrieve the email/key\
  \ credentials from environment variables:\n- email: os.environ.get(\"API_EPA_AQS_EMAIL\"\
  )\n- api_key: os.environ.get(\"API_EPA_AQS\")\nDo not use placeholder auth values\
  \ from the OpenAPI spec nor prompt the user for these values, just use the environment\
  \ variables.\n\nEnsure you know the fields that come back from the OpenAPI spec\
  \ in order to process the AQS data.\n\nDaily/yearly data can only be accessed one\
  \ year at a time. If working for that in year/decade ranges, prefer to use the annualData\
  \ endpoints, as the daily data may be too large to fit into context.\nIf the user\
  \ requests data for a year range, you will need to make multiple requests to the\
  \ API- potentially sampling in between, or creating averages, in order to not make\
  \ requests for every single year in the range.\nThe earliest sample in the data\
  \ set is from 1957. Year 1980 marks the beginning of nationally consistent operational\
  \ and quality assurance procedures.\n\nMeasured entities in the AQS data set are\
  \ referred to as parameters (which includes pollutants/substances), and use integer\
  \ codes specific to AQS.\n\nIf a monitor is scheduled to collect data and does not\
  \ it will contain `null` data. This is a placeholder to let EPA know that more data\
  \ will not be forthcoming.    AQS does place absolute limits on the values that\
  \ can be submitted.\nHowever, these are fairly liberal limits- for many parameters,\
  \ negative values are acceptable.\nAQS has a nominal quarterly reporting deadline:\
  \ data must be reported by 90 days after the end of the calendar quarter in which\
  \ they are collected.\n\nIf you need to inspect the data of a JSON response before\
  \ processing, and you're dealing with annual data, or multi-daily data, or\nfor\
  \ a geographic region that could yield too much data to process (or fit into an\
  \ LLM context window),\n\nbetter use this endpoint:\n```\n/metaData/fieldsByService?email={{email}}&key={{key}}&service=annualData\n\
  ```\n(example above is checking shape of annualData endpoint). It will provide fields\
  \ documentation for each property in the response.\nIf you use `print(response_data)`\
  \ on a huge JSON response, you will not be able to proceed- you can also try checking\
  \ the length as string,\nand if that's too long, inspect whatever amount of characters\
  \ that would be enough.\nThat is, never do:\n```\ndata = response.json()\nprint(data)\n\
  ```\ninstead, either use fieldsByService endpoint as described earlier, or use the\
  \ Example 3 below (in the #Examples section) to generate a schema and inspect the\
  \ data.\n\nIMPORTANT: `parameter_name` is not a property in the respponse usually,\
  \ check `parameter` or `parameter_code` in responses first instead!\n\n# Output\
  \ Format for the AQS API - JSON\nThe only output format available from the services\
  \ is JSON. This is in conformity with the 18f API standards for government.\n\n\
  The JSON response has two top-level elements. A header and a body. The header contains\
  \ information about the request and the body contains the data.\n\nThe header contains\
  \ the following elements:\n\n- `status`. \"SUCCESS\" if the request returned data.\
  \ \"FAILED\" if the request could not be processed. \"No data matched your selection\"\
  \ if the request was processed but resulted in no data.\n- `request_time`. The date\
  \ and time (at the location of the server) when the request was received.\n- `url`.\
  \ The original URL that was submitted to make the request.\n- `row`. The number\
  \ of rows of data in the body object.\n- `errors`. Any errors encountered when attempting\
  \ to respond to the request.\nThe body is an array with one object per data row.\
  \ The contents of the object will vary based on the request made. (E.g. the columns\
  \ of data returned are different for each query.\n\nHere is a sample of the output\
  \ of a Raw Data request with one data point:\n```\n    {\n        \"Header\": [\n\
  \        {\n            \"status\": \"success\",\n            \"request_time\":\
  \ \"2018-06-13T07:45:01-04:00\",\n            \"url\": \"https://...\",\n      \
  \      \"rows\": 1\n        }\n        ],\n        \"Body\": [\n        {\n    \
  \        \"state_code\": \"01\",\n            \"county_code\": \"073\",\n      \
  \      \"site_number\": \"0023\",\n            \"parameter_code\": \"88101\",\n\
  \            \"poc\": 1.0,\n            \"latitude\": 33.0,\n            \"longitude\"\
  : -86.0,\n            \"datum\": \"WGS84\",\n            \"parameter_name\": \"\
  PM2.5 - Local Conditions\",\n            \"date_local\": \"2017-04-01\",\n     \
  \       \"time_local\": \"00:00\",\n            \"date_gmt\": \"2017-04-01\",\n\
  \            \"time_gmt\": \"06:00\",\n            \"sample_measurement\": 6.2,\n\
  \            \"unit_of_measure\": \"Micrograms/cubic meter (LC)\",\n           \
  \ \"detection_limit\": 2.0,\n            \"uncertainty\": null,\n            \"\
  qualifiers\": null,\n            \"method_type\": \"FRM\",\n            \"method_code\"\
  : \"142\",\n            \"method_name\": \"BGI Models PQ200-VSCC or PQ200A-VSCC\
  \ - Gravimetric\",\n            \"state_name\": \"Alabama\",\n            \"county_name\"\
  : \"Jefferson\",\n            \"date_of_last_change\": \"2017-05-30\",\n       \
  \     \"cbsa_code\": \"13820\"\n        }\n        ]\n    }\n```\n\n# Error Handling\
  \ and Status Codes\nIf the API is able to parse your request it will return the\
  \ JSON described above and an HTTP status of 200.\n\nIf the API is not able to parse\
  \ your request it will return a status code of 400 and only the header, which will\
  \ include an array of error messages instead of a row count.\nFor example:\n```\n\
  \    {\n        \"Header\": [{\n            \"status\": \"Failed\",\n          \
  \  \"request_time\": \"2018-06-13T08:05:46.588-04:00\",\n            \"url\": \"\
  https://...\",\n            \"error\": [\n                \"value is missing or\
  \ the value is empty: param\"\n                ]\n        }],\n        \"Body\"\
  : []\n    }\n```\n\nIf the API is able to parse your request but no data matches\
  \ your selections, it will return the\nJSON header and an HTTP status of 200. The\
  \ row count will be zero,\nthe status will be a message that no data matched your\
  \ selection criteria,\nand the body will be empty.\n```\n{\n    \"Header\": [\n\
  \    {\n        \"status\": \"No data matched your selection\",\n        \"request_time\"\
  : \"2018-06-13T10:15:42-04:00\",\n        \"url\": \"https://...\",\n        \"\
  rows\": 0\n    }\n    ],\n    \"Body\": []\n}\n```\n\n# Request Limits and Terms\
  \ of Service\nThe API has the following limits imposed on request size:\n\n- Length\
  \ of time. All services (except Monitor) must have the end date (edate field) be\
  \ in the same year as the begin date (bdate field).\n- Number of parameters. Most\
  \ services allow for the selection of multiple parameter codes (param field). A\
  \ maximum of 5 parameter codes may be listed in a single request.\n\nPlease adhere\
  \ to the following when using the API:\n\n- _Limit the size of queries_. Our database\
  \ contains billions of values and you may request more than you intend. If you are\
  \ unsure of the amount of data, start small and work your way up. We request that\
  \ you limit queries to 1,000,000 rows of data each. You can use the \"observation\
  \ count\" field on the annualData service to determine how much data exists for\
  \ a time-parameter-geography combination. If you have any questions or need advice,\
  \ please contact us.\n- _Limit the frequency of queries_. Our system can process\
  \ a limited load. If scripting requests, please wait for one request to complete\
  \ before submitting another and do not make more than 10 requests per minute. Also,\
  \ we request a pause of 5 seconds between requests and adjust accordingly for response\
  \ time and size.\nIf you violate these terms, we may disable your account without\
  \ notice (but we will be in contact via the email address provided).\n\n# Usage\
  \ tips\nThis section contains suggestions for completing certain data related tasks\
  \ and links to software tools using the API.\n\n- Determine if or how much data\
  \ exists for a time-parameter-geography combination:\n    - Retrieve data using\
  \ the annualData service.\n    - If no records are returned, we do not have the\
  \ data.\n    - If records are returned, use the observation count to determine the\
  \ temporal and geographic distribution of the data.\n\n- Monthly averages:\n   \
  \ - AQS does not routinely calculate monthly aggregate statistics.\n    - If you\
  \ need these, you must calculate them yourself.\n    - These can be calculated from\
  \ the sample data or the daily data without loss of fidelity.\n\n- Determine a single\
  \ value for a site with collocated monitors:\n    - Many sites will have collocated\
  \ monitors - monitors collecting the same parameter at the same time.\n    - The\
  \ API currently provides only monitor level values. (We anticipate adding site-level\
  \ values at some point.)\n    - For some criteria pollutants (PM2.5, ozone, lead,\
  \ and NO2), the regulations define procedures for defining a single site-level value.\n\
  \    - For other pollutants, determining a single site-level value is left to the\
  \ investigator.\n\n# More Details\n## API Structure and Capabilities\n- The EPA\
  \ AQS API provides access to air quality data from monitoring stations across the\
  \ US\n- Data is available at multiple temporal resolutions: annual, quarterly, daily,\
  \ and sample-level.\n- Data can be queried at various geographic levels: state,\
  \ county, site, CBSA, and bounding box\n- The API returns data in JSON format with\
  \ a standard structure\n- Key pollutants relevant to asthma (ozone, PM2.5, NO2,\
  \ SO2, CO) are available through the API\n- Data can be used to analyze both acute\
  \ exposures (daily data) and chronic exposures (annual data)\n- Seasonal patterns\
  \ in air quality can be correlated with seasonal patterns in asthma exacerbations\n\
  - The API enables spatial analysis to identify potential hotspots of poor air quality\n\
  \n## Data Integration Strategies\n- Geographic alignment: Use census tract or ZIP\
  \ code as common geographic units\n- Temporal alignment: Monthly aggregation captures\
  \ seasonal patterns while managing data volume\n- Spatial interpolation can estimate\
  \ air quality values between monitoring stations\n- Population-weighted averages\
  \ can be used when aggregating to larger geographic areas\n- A standardized spatial\
  \ grid can facilitate integration with other environmental datasets\n\n## Key Parameters\
  \ for Asthma Research\nThe API provides access to several air pollutants known to\
  \ affect respiratory health:\n```\nParameter Code\tParameter Name\tRelevance to\
  \ Asthma\n44201\tOzone\tMajor trigger for asthma attacks\n88101\tPM2.5\tCan penetrate\
  \ deep into lungs\n81102\tPM10\tCan irritate airways\n42602\tNitrogen Dioxide (NO2)\t\
  Common in vehicle emissions\n42401\tSulfur Dioxide (SO2)\tIndustrial emissions linked\
  \ to respiratory issues\n42101\tCarbon Monoxide\t(CO)    Affects oxygen transport\n\
  ```\n\n## Key Endpoints and Parameters\nThe API offers several endpoint categories:\n\
  \n- Monitoring Sites: monitors/byCounty - Returns information about monitoring stations\n\
  - Daily Data: dailyData/byCounty - Daily measurements for parameters\n- Annual Data:\
  \ annualData/byCounty - Yearly aggregated measurements\n- Sample Data: sampleData/byCounty\
  \ - Individual sample measurements\n- Metadata: Various endpoints for parameter\
  \ codes, classes, etc.\n\nAll data requests require:\n- Geographic parameters (state/county\
  \ codes)\n- Date parameters (bdate/edate in YYYYMMDD format)\n- Parameter code for\
  \ the pollutant\n\n# Implementation Challenges and Solutions\n- Date Parameter Requirements:\
  \ Despite documentation suggesting otherwise, all data endpoints require explicit\
  \ date parameters (bdate and edate), not just the year parameter.\n- Data Volume\
  \ Management: Harris County has numerous monitoring stations (we found 24,532 daily\
  \ ozone records for 2022 alone), requiring efficient data aggregation strategies.\n\
  - Parameter Identification: The API requires specific parameter codes rather than\
  \ names, necessitating lookup of these codes before querying data.\n\nThe EPA AQS\
  \ API provides rich, detailed air quality data that can be invaluable\nfor researching\
  \ environmental factors affecting childhood asthma (and others).\nBy combining this\
  \ data with health outcome data from other sources, researchers\ncan develop comprehensive\
  \ analyses of how air quality impacts respiratory health\nin specific geographic\
  \ areas like a county or region.\nThe API's structure allows for flexible querying\
  \ by location, time period, and\nspecific pollutants, making it a powerful tool\
  \ for environmental health research.\nHowever, users should be aware of specific\
  \ parameter requirements and prepare\nfor handling large volumes of data when working\
  \ with densely monitored areas.\n\nNote: If/when using the `metaData/isAvailable`\
  \ endpoint to check if the API is available,\nuse this sample response as guide:\n\
  ```\n{\n    \"Header\": [\n        {\n            \"status\": \"API service is up\
  \ and running healthy. Status: connection_pool: size: 5, connections: 1, in use:\
  \ 1, waiting_in_queue: 0\",\n        \"request_time\": \"2025-03-21T08:21:41-04:00\"\
  ,\n        \"url\": \"http://aqs.epa.gov/api/metaData/isAvailable?email={{email}}.com&key={{key}}\"\
  \n        }\n    ],\n    \"Data\": []\n}\n```\nNever simulate this API- if it is\
  \ not available ask the user how to proceed.\n"
url: null
uuid: 18e5974c-8cea-4fe7-88db-7c5779a17d5d
