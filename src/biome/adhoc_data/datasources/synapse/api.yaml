name: "NF Synapse"
integration_type: api
description: |
    The NF Synapse API is a RESTful API that allows you to interact with the Neurofibromatosis Data Portal.
    It additionally contains a Python client that can be used to interact with the API (on the package `synapseclient`, already installed in the environment).
    The code drafter has access both to the openapi spec, the web docs, and the python client documentation.

attachments:
  raw_documentation: SynapseOpenApiSpec.json
  web_docs: web_docs.md
  python_client: nf_programmatic_webdocs.md

prompt: |
    # OpenAPI Spec JSON:
    ${raw_documentation}

    # Additional Instructions:

    This API is through OpenAPI Spec. You have been provided the schema.
    All requests go to the following URL: https://repo-prod.prod.sagebase.org
    That is the base URL for all requests.

    To use the Synapse API always retrieve the auth header token from the environment variable:
    - bearer token: os.environ.get("API_SYNAPSE")
    Do not use placeholder auth values from the OpenAPI spec nor prompt the user for these values, just use the environment variables.

    Ensure you know the fields that come back from the OpenAPI spec in order to process the Synapse data.

    Never simulate this API- if it is not available ask the user how to proceed.

    You will mostly have to use the /repo/v1 and /file/v1 paths.
    For example you can start search with:
    POST /repo/v1/search

    and once you find a project or dataset you like, you can proceed to exploreother entities in
    order to find a file / file handle and download it.

    An example file handle we found: syn4988822 with it, you can issue a download request.
    You'll need to find the file ID first depending on your needs and the user query.

    You only have read/view/download assess/permissions- don't try to create or upload data- the openapi spec may have create/upload endpoints but do not use them.

    # More Web Docs:
    ${web_docs}

    # Example issuing a POST to search for `High throughput analysis of pNF cell lines` (omitting auth bearer token header; eg Authorization: Bearer <token>)
    ```
    POST https://repo-prod.prod.sagebase.org/repo/v1/search
    {
      "queryTerm": [
        "Blakeley"
      ],
      "rangeQuery": [],
      "facetOptions": [],
      "returnFields": [],
      "start": 0,
      "size": "10"
    }
    ```

    # Python Client
    ${python_client}

    # About the NF synapse subdomain

    NF Data Portal
    A home for Neurofibromatosis research resources

    Files are data collected from from human samples, animal models, and cell lines from a variety of assays.
    Datasets are curated collections of files organized to facilitate data sharing.
    Initiatives are funder-organized programs, groups, consortia, cohorts, or awards, usually focused on a specific research area in neurofibromatosis.
    Studies are hypothesis-driven projects with the goal of uncovering new knowledge about neurofibromatosis type 1, type 2, or schwannomatosis.
    Papers are pre-prints and peer-reviewed articles produced by NF Data Portal studies
    Tools include animal models, cell lines, genetic reagents, antibodies, and biobanks related to NF!

    Example of initializing the python client providing download dir and login token credentials:
    ```
    import synapseclient, os
    from pathlib import Path

    downloads_dir = Path(__file__).parent.parent / "downloads" / "synapse"

    syn = synapseclient.Synapse(cache_root_dir=downloads_dir)
    syn.login(authToken=os.environ.get("API_SYNAPSE"))  # pass in the authToken on python client login!
    ```
