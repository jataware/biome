- query: Search for dementia studies in Synapse
  code: |-
    import os
    import requests
    import pandas as pd

    BASE_URL = "https://repo-prod.prod.sagebase.org"
    AUTH_TOKEN = os.environ.get("API_SYNAPSE")
    HEADERS = {"Authorization": f"Bearer {AUTH_TOKEN}"}

    search_terms = [
        "dementia",
        "Alzheimer",
        "cognitive decline",
        "neurodegenerative",
        "memory loss",
        "Parkinson",
        "Lewy body",
        "frontotemporal",
        "MCI",
        "mild cognitive impairment"
    ]

    results = []
    for term in search_terms:
        payload = {
            "queryTerm": [term],
            "rangeQuery": [],
            "facetOptions": [],
            "returnFields": [],
            "start": 0,
            "size": 50
        }
        resp = requests.post(
            f"{BASE_URL}/repo/v1/search",
            headers=HEADERS,
            json=payload
        )
        resp.raise_for_status()
        data = resp.json()
        for hit in data.get("hits", []):
            results.append({
                "id": hit.get("id"),
                "name": hit.get("name"),
                "description": hit.get("description"),
                "type": hit.get("node_type"),
                "created_on": hit.get("created_on"),
                "modified_on": hit.get("modified_on"),
                "created_by": hit.get("created_by"),
                "modified_by": hit.get("modified_by"),
            })

    df = pd.DataFrame(results).drop_duplicates(subset=["id"])
    # Filter for likely datasets, projects, or studies by type or name/description
    mask = (
        df["type"].str.lower().isin(["project", "dataset", "study", "folder", "entityview", "submissionview", "materializedview", "table"])
        | df["name"].str.contains("study|dataset|project", case=False, na=False)
        | df["description"].str.contains("study|dataset|project", case=False, na=False)
    )
    filtered = df[mask]

    print(f"Found {len(filtered)} dementia-related studies/datasets in Synapse")
    print("\nBreakdown by type:")
    print(filtered['type'].value_counts())
    print("\nTop 10 results:")
    print(filtered.head(10)[['id', 'name', 'type']].to_string())
  notes: This example demonstrates how to search Synapse for studies related to dementia
    and neurodegenerative diseases. It uses multiple search terms to capture various
    types of dementia research (Alzheimer's, Parkinson's, MCI, etc.) and filters results
    to focus on actual studies, datasets, and projects rather than individual files.
    The search found 229 relevant studies across different research areas including
    biomarker discovery, genomics, proteomics, and clinical assessments. Key studies
    include the Alzheimer's Disease Community Portal, multi-modal datasets for automatic
    dementia detection, and various biomarker investigation projects.
